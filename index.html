<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BLOB.IO</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        body { margin: 0; overflow: hidden; background-color: #000; font-family: 'Orbitron', sans-serif; user-select: none; }
        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10; }
        .screen { position: absolute; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: rgba(0,0,0,0.4); backdrop-filter: blur(5px); pointer-events: auto; opacity: 0; transition: opacity 0.5s; pointer-events: none; }
        .active { opacity: 1; pointer-events: auto; }
        h1 { font-size: 8vw; color: #fff; text-shadow: 0 0 20px #0ff, 0 0 50px #0ff; margin: 0; letter-spacing: 5px; text-transform: uppercase; }
        button { background: transparent; border: 2px solid #0ff; color: #0ff; padding: 15px 40px; font-size: 1.5rem; font-family: 'Orbitron', sans-serif; cursor: pointer; margin-top: 30px; text-transform: uppercase; letter-spacing: 2px; transition: 0.3s; box-shadow: 0 0 15px #0ff; }
        button:hover { background: #0ff; color: #000; box-shadow: 0 0 30px #0ff; }
        #score-hud { position: absolute; top: 20px; left: 20px; color: #fff; font-size: 1.5rem; pointer-events: none; text-shadow: 0 0 10px #fff; z-index: 5; display: none; }
        #wave-hud { position: absolute; top: 50px; left: 20px; color: #ff0000; font-size: 1.2rem; pointer-events: none; text-shadow: 0 0 10px #f00; z-index: 5; display: none; }
        #final-score { font-size: 3rem; color: #fff; margin-bottom: 20px; }
        canvas { display: block; }
        #leaderboard { position: absolute; top: 80px; right: 20px; color: #fff; text-align: right; pointer-events: none; z-index: 5; display: none; }
        #leaderboard h3 { margin: 0 0 10px 0; font-size: 1.2rem; text-shadow: 0 0 10px #0ff; letter-spacing: 2px; }
        #leaderboard ul { list-style: none; padding: 0; margin: 0; }
        #leaderboard li { font-size: 1rem; margin-bottom: 5px; text-shadow: 0 0 5px #fff; font-family: 'Orbitron', sans-serif; }
        #boost-hud { position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%); width: 300px; height: 15px; border: 2px solid #fff; border-radius: 10px; display: none; z-index: 5; box-shadow: 0 0 10px #0ff; background: rgba(0,0,0,0.5); }
        #boost-fill { width: 100%; height: 100%; background: #0ff; transform-origin: left; border-radius: 8px; transition: width 0.1s, background-color 0.3s; }
        #boost-text { position: absolute; top: -25px; width: 100%; text-align: center; color: #0ff; font-size: 0.9rem; letter-spacing: 2px; text-shadow: 0 0 5px #0ff; font-weight: bold; }
        #combo-hud { position: absolute; top: 80px; left: 20px; color: #ff0055; font-size: 2rem; font-weight: 900; text-shadow: 0 0 10px #ff0055; display: none; transform: skewX(-10deg); transition: transform 0.1s; }
        #compass { position: absolute; top: 100px; left: 50%; transform: translateX(-50%); display: none; z-index: 5; text-align: center; }
        #compass-arrow { font-size: 3rem; color: #00ffff; text-shadow: 0 0 10px #00ffff; transition: transform 0.1s; display: inline-block; }
        #compass-label { font-size: 0.8rem; color: #fff; margin-top: -5px; text-shadow: 0 0 5px #fff; letter-spacing: 2px; }
        .floating-msg { position: absolute; font-weight: 900; font-size: 1.5rem; pointer-events: none; text-shadow: 0 0 5px #000; white-space: nowrap; transition: opacity 0.2s; }
        #text-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; overflow: hidden; z-index: 8; }
        #settings-btn { position: absolute; top: 20px; right: 20px; z-index: 20; cursor: pointer; color: #0ff; border: 2px solid #0ff; padding: 5px 15px; font-size: 1rem; background: rgba(0,0,0,0.5); box-shadow: 0 0 10px #0ff; transition: 0.3s; pointer-events: auto; }
        #settings-btn:hover { background: #0ff; color: #000; }
        .skin-btn { width: 60px; height: 60px; border-radius: 50%; border: 2px solid #fff; margin: 0 10px; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; display: inline-block; }
        .skin-btn:hover, .skin-btn.selected { transform: scale(1.2); box-shadow: 0 0 15px #fff; border-color: #0ff; }
        .mode-btn { background: rgba(0,0,0,0.5); border: 1px solid #fff; color: #fff; padding: 10px 20px; cursor: pointer; margin: 0 5px; font-family: 'Orbitron', sans-serif; font-size: 0.8rem; transition: 0.3s; }
        .mode-btn:hover, .mode-btn.selected { background: #0ff; color: #000; box-shadow: 0 0 10px #0ff; border-color: #0ff; }
        #powerup-hud { position: absolute; bottom: 80px; left: 50%; transform: translateX(-50%); display: flex; gap: 20px; pointer-events: none; }
        .powerup-icon { width: 50px; height: 50px; border: 2px solid #fff; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; color: #fff; background: rgba(0,0,0,0.5); box-shadow: 0 0 10px #fff; opacity: 0; transition: opacity 0.3s; }
        .powerup-icon.active { opacity: 1; }

        /* Mobile Optimizations */
        @media (max-width: 768px) or (orientation: portrait) {
            h1 { font-size: 15vw; }
            button { padding: 20px 50px; font-size: 1.8rem; }
            #score-hud, #wave-hud { font-size: 1.8rem; }
            .mode-btn { padding: 15px 25px; font-size: 1rem; margin: 5px; }
            #boost-hud { bottom: 180px; width: 80%; }
            #powerup-hud { bottom: 220px; }
        }

        /* Pro Game Over Styles */
        #gameover-screen h1 { font-size: 5rem; color: #ff0055; text-shadow: 0 0 20px #ff0055; margin: 0 0 40px 0; letter-spacing: 10px; animation: glitch 0.2s infinite; }
        .stats-box { background: rgba(0, 0, 0, 0.9); border: 1px solid #333; border-left: 5px solid #ff0055; padding: 40px; width: 350px; margin-bottom: 40px; transform: skewX(-5deg); box-shadow: 0 0 50px rgba(255, 0, 85, 0.2); }
        .stat-row { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 20px; border-bottom: 1px solid #222; padding-bottom: 5px; }
        .stat-row:last-child { border-bottom: none; margin-bottom: 0; }
        .stat-label { color: #888; font-size: 0.9rem; letter-spacing: 3px; text-transform: uppercase; }
        .stat-val { color: #fff; font-weight: 900; text-shadow: 0 0 10px #fff; font-size: 1.8rem; }
        .stat-val.highlight { color: #0ff; text-shadow: 0 0 15px #0ff; font-size: 2.2rem; }
        .btn-group { display: flex; gap: 20px; }
        @keyframes glitch {
            0% { text-shadow: 3px 0 0 #0ff, -3px 0 0 #f00; transform: translate(2px, 0); }
            100% { text-shadow: -3px 0 0 #0ff, 3px 0 0 #f00; transform: translate(-2px, 0); }
        }
    </style>
</head>
<body>

<div id="ui-layer">
    <div id="text-layer"></div>
    <div id="intro-screen" class="screen active">
        <h1 id="game-title" style="opacity: 0; transition: opacity 2s;">BLOB.IO</h1>
        <div id="intro-controls" style="margin-top: 20px; opacity: 0; transition: opacity 1s;">
            <div class="skin-btn selected" data-skin="0" style="background: radial-gradient(circle, #0ff, #000);"></div>
            <div class="skin-btn" data-skin="1" style="background: repeating-linear-gradient(0deg, #0ff, #000 10px);"></div>
            <div class="skin-btn" data-skin="2" style="background: conic-gradient(#0ff, #000, #0ff);"></div>
        </div>
        <div id="mode-select" style="margin-top: 20px; opacity: 0; transition: opacity 1s;">
            <button class="mode-btn selected" data-mode="FFA">FFA</button>
            <button class="mode-btn" data-mode="TDM">TDM</button>
            <button class="mode-btn" data-mode="CTF">CTF</button>
            <button class="mode-btn" data-mode="SURVIVAL">SURVIVAL</button>
        </div>
        <button id="start-btn">START</button>
    </div>
    <div id="gameover-screen" class="screen">
        <h1>TERMINATED</h1>
        <div class="stats-box">
            <div class="stat-row"><span class="stat-label">Final Mass</span><span id="go-mass" class="stat-val highlight">0</span></div>
            <div class="stat-row"><span class="stat-label">Time Alive</span><span id="go-time" class="stat-val">00:00</span></div>
            <div class="stat-row"><span class="stat-label">Eliminations</span><span id="go-kills" class="stat-val">0</span></div>
            <div class="stat-row"><span class="stat-label">Wave Reached</span><span id="go-wave" class="stat-val">1</span></div>
        </div>
        <div class="btn-group">
            <button id="restart-btn">REINITIALIZE</button>
            <button id="menu-btn" style="border-color: #666; color: #aaa;">MENU</button>
        </div>
    </div>
    <div id="score-hud">MASS: 100</div>
    <div id="wave-hud">WAVE: 1</div>
    <div id="combo-hud">COMBO x1</div>
    <div id="compass">
        <div id="compass-arrow">‚û§</div>
        <div id="compass-label">CENTER</div>
    </div>
    <div id="leaderboard">
        <h3>LEADERBOARD</h3>
        <ul id="leaderboard-list"></ul>
    </div>
    <div id="boost-hud">
        <div id="boost-text">BOOST READY</div>
        <div id="boost-fill"></div>
    </div>
    <div id="powerup-hud">
        <div id="icon-shield" class="powerup-icon" style="border-color: #00ffff; box-shadow: 0 0 10px #00ffff;">üõ°Ô∏è</div>
        <div id="icon-stealth" class="powerup-icon" style="border-color: #aa00ff; box-shadow: 0 0 10px #aa00ff;">üëª</div>
        <div id="icon-vision" class="powerup-icon" style="border-color: #00ff00; box-shadow: 0 0 10px #00ff00;">üëÅÔ∏è</div>
        <div id="icon-magnet" class="powerup-icon" style="border-color: #ffff00; box-shadow: 0 0 10px #ffff00;">üß≤</div>
    </div>
    <div id="settings-btn">SETTINGS</div>
    <div id="skip-intro-btn" style="position: absolute; bottom: 30px; right: 30px; z-index: 20; cursor: pointer; color: #fff; border: 1px solid #fff; padding: 10px 20px; font-size: 1rem; background: rgba(0,0,0,0.5); display: none; opacity: 0; transition: opacity 1s; pointer-events: auto;">SKIP INTRO >></div>
    <div id="settings-modal" class="screen" style="z-index: 100; display: none;">
        <div style="background: rgba(0,0,0,0.9); padding: 40px; border: 2px solid #0ff; box-shadow: 0 0 30px #0ff; text-align: center; min-width: 300px; transform: skewX(-5deg);">
            <h2 style="color: #fff; margin: 0 0 30px 0; text-shadow: 0 0 10px #0ff; letter-spacing: 5px;">SYSTEM CONFIG</h2>
            <div style="margin-bottom: 30px; text-align: left;">
                <label style="display: flex; justify-content: space-between; align-items: center; color: #fff; font-size: 1.2rem; margin-bottom: 15px; cursor: pointer;">
                    <span>VISUAL FX (BLOOM)</span>
                    <input type="checkbox" id="opt-bloom" checked style="accent-color: #0ff; transform: scale(1.5);">
                </label>
                <label style="display: flex; justify-content: space-between; align-items: center; color: #fff; font-size: 1.2rem; margin-bottom: 15px; cursor: pointer;">
                    <span>PARTICLES</span>
                    <input type="checkbox" id="opt-particles" checked style="accent-color: #0ff; transform: scale(1.5);">
                </label>
                <label style="display: flex; justify-content: space-between; align-items: center; color: #fff; font-size: 1.2rem; margin-bottom: 15px; cursor: pointer;">
                    <span>AUDIO</span>
                    <input type="checkbox" id="opt-audio" checked style="accent-color: #0ff; transform: scale(1.5);">
                </label>
            </div>
            <div id="credits-section" style="display: none; margin-bottom: 30px; text-align: center; color: #fff;">
                <h3 style="color: #0ff; margin-bottom: 10px;">CREDITS</h3>
                <p>Lead Developer: Patrick JAILLET</p>
                <p>Website: http://sandefjord.hopto.org/</p>
                <p>Engine: Three.js</p>
                <p>Version: 1.0.0</p>
            </div>
            <button id="credits-btn" style="margin-top: 0; padding: 10px 30px; font-size: 1rem; border-color: #fff; color: #fff; margin-right: 10px;">CREDITS</button>
            <button id="close-settings-btn" style="margin-top: 0; padding: 10px 30px; font-size: 1.2rem;">RESUME</button>
        </div>
    </div>
</div>

<script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
</script>
<script type="module" src="./main.js"></script>
</body>
</html>
